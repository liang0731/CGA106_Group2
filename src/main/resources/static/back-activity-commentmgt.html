<!DOCTYPE html>
<html lang="en" class="h-100">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, shrink-to-fit=9">
    <meta name="description" content="Gambolthemes">
    <meta name="author" content="Gambolthemes">
    <title>ezTicket - 一站式購票體驗</title>

    <!-- Favicon Icon -->
    <link rel="icon" type="image/png" href="images/ezTicket.png">

    <!-- Stylesheets -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
            href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
            rel="stylesheet">
    <link href='vendor/unicons-2.0.1/css/unicons.css' rel='stylesheet'>
    <link href="css/style.css" rel="stylesheet">
    <link href="css/vertical-responsive-menu.min.css" rel="stylesheet">
    <link href="css/responsive.css" rel="stylesheet">

    <!-- Vendor Stylesheets -->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet">
    <link href="vendor/OwlCarousel/assets/owl.carousel.css" rel="stylesheet">
    <link href="vendor/OwlCarousel/assets/owl.theme.default.min.css" rel="stylesheet">
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="vendor/bootstrap-select/dist/css/bootstrap-select.min.css" rel="stylesheet">

    <!-- 將文字縮成刪節號 -->
    <style>
        .ellipsis {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
    </style>
</head>

<body class="d-flex flex-column h-100">

<!-- Header Start-->
<!-- 請加上這行-->
<link href="css/shawn-scroll-bar.css" rel="stylesheet">

<header class="header">
    <div class="header-inner">
        <nav
                class="navbar navbar-expand-lg bg-barren barren-head navbar fixed-top justify-content-sm-start pt-0 pb-0 ps-lg-0 pe-2">
            <div class="container-fluid ps-0">
                <button type="button" id="toggleMenu" class="toggle_menu">
                    <i class="fa-solid fa-bars-staggered"></i>
                </button>
                <button id="collapse_menu" class="collapse_menu me-4" disabled>
                    <i class="fa-solid fa-bars collapse_menu--icon "></i>
                    <span class="collapse_menu--label"></span>
                </button>
                <button class="navbar-toggler order-3 ms-2 pe-0" type="button" data-bs-toggle="offcanvas"
                        data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
                        <span class="navbar-toggler-icon">
                            <i class="fa-solid fa-bars"></i>
                        </span>
                </button>
                <a class="navbar-brand order-1 order-lg-0 ml-lg-0 ml-2 me-auto" href="index.html">
                    <div class="res-main-logo">
                        <img src="images/ezTicket-icon.svg" alt="">
                    </div>
                    <div class="main-logo" id="logo">
                        <img src="images/ezTicket.svg" alt="">
                        <img class="logo-inverse" src="images/dark-logo.svg" alt="">
                    </div>
                </a>
                <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasNavbar"
                     aria-labelledby="offcanvasNavbarLabel">
                    <div class="offcanvas-header">
                        <div class="offcanvas-logo" id="offcanvasNavbarLabel">
                            <img src="images/ezTicket-icon.svg" alt="">
                        </div>
                        <button type="button" class="close-btn" data-bs-dismiss="offcanvas" aria-label="Close">
                            <i class="fa-solid fa-xmark"></i>
                        </button>
                    </div>
                    <div class="offcanvas-body">
                        <ul class="navbar-nav justify-content-end flex-grow-1 pe_5">
                            <li class="nav-item">
                                <a class="nav-link" href="back-index.html">
                                    <i class="fa-solid fa-house me-2"></i>首頁
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="right-header order-2">
                    <ul class="align-self-stretch">
                        <li class="6">
                            <a href="back-activity-ticket-inspec.html" class="create-btn btn-hover">
                                <i class="fa-solid fa-ticket"></i>
                                <span>票務</span>
                            </a>
                        </li>
                        <li class="dropdown account-dropdown order-3">
                            <a href="#" class="account-link" role="button" id="accountClick"
                               data-bs-auto-close="outside" data-bs-toggle="dropdown" aria-expanded="false">
                                <img src="images/profile-imgs/img-13.jpg" class="D-baimg" alt="">
                                <i class="fas fa-caret-down arrow-icon"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-account dropdown-menu-end"
                                aria-labelledby="accountClick">
                                <li>
                                    <div class="dropdown-account-header">
                                        <div class="account-holder-avatar">
                                            <img src="images/profile-imgs/img-13.jpg" class="D-baimg" alt="">
                                        </div>
                                        <h5 class="D-baname"><!-- 姓名 --></h5>
                                        <p class="D-baemail"><!-- email --></p>
                                    </div>
                                </li>
                                <li class="profile-link">
                                    <a href="back-users-profile.html" class="link-item">個人資料管理</a>
                                    <a href="front-users-bu-sign-in.html" class="link-item logOut">登出</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="overlay"></div>
    </div>
</header>
<!-- Header End-->
<!-- Left Sidebar Start -->
<nav class="vertical_nav" style="overflow: auto!important;">
    <div class="left_section menu_left" id="js-menu">
        <div class="left_section">
            <ul>
                <div id="havefunc" style="background-color: #004895; display: flex; justify-content: center; align-items: center;">
                    <p class="D-barole" style="color: white; text-align: center; margin: 0;"></p>
                </div>
                <li class="menu--item 10">
                    <!-- 缺網址 -->
                    <a href="#" class="menu--link" title="最新消息管理" data-bs-toggle="tooltip"
                       data-bs-placement="right">
                        <i class="fa-solid fa-newspaper menu--icon"></i>
                        <span class="menu--label">最新消息管理</span>
                    </a>
                </li>
                <li class="menu--item 19">
                    <a href="back-activity-eventdashboard.html" class="menu--link" title="節目管理" data-bs-toggle="tooltip" data-bs-placement="right">
                        <i class="fa-solid fa-calendar-days menu--icon"></i>
                        <span class="menu--label">節目管理</span>
                    </a>
                </li>
                <li class="menu--item 19" style="display: none;">
                    <!-- 缺網址 -->
                    <a href="#" class="menu--link" title="節目類別管理" data-bs-toggle="tooltip"
                       data-bs-placement="right">
                        <i class="fa-solid fa-folder menu--icon"></i>
                        <span class="menu--label">節目類別管理</span>
                    </a>
                </li>
                <li class="menu--item 21">
                    <a href="back-activity-seatmgt-allactivity.html" class="menu--link" title="節目座位管理"
                       data-bs-toggle="tooltip" data-bs-placement="right">
                        <i class="fa-solid fa-chair menu--icon"></i>
                        <span class="menu--label">節目座位管理</span>
                    </a>
                </li>
                <li class="menu--item 20">
                    <a href="back-activity-commentmgt.html" class="menu--link" title="節目評論管理"
                       data-bs-toggle="tooltip" data-bs-placement="right">
                        <i class="fa-solid fa-comments menu--icon"></i>
                        <span class="menu--label">節目評論管理</span>
                    </a>
                </li>
                <li class="menu--item 18">
                    <a href="back-activity-torder_manage.html" class="menu--link" title="票券訂單管理"
                       data-bs-toggle="tooltip" data-bs-placement="right">
                        <i class="fa-solid fa-file-invoice menu--icon"></i>
                        <span class="menu--label">票券訂單管理</span>
                    </a>
                </li>
                <li class="menu--item 22">
                    <a href="back-activity-model-place.html" class="menu--link" title="場地模板管理"
                       data-bs-toggle="tooltip" data-bs-placement="right">
                        <i class="fa-solid fa-couch menu--icon"></i>
                        <span class="menu--label">場地模板管理</span>
                    </a>
                </li>
                <li class="menu--item 17">
                    <a href="back-product-product_manage.html" class="menu--link" title="商品管理"
                       data-bs-toggle="tooltip" data-bs-placement="right">
                        <i class="fa-solid fa-bag-shopping menu--icon"></i>
                        <span class="menu--label">商品管理</span>
                    </a>
                </li>
                <li class="menu--item 17">
                    <a href="back-product-pclass_manager.html" class="menu--link" title="商品類別管理"
                       data-bs-toggle="tooltip" data-bs-placement="right">
                        <i class="fa-regular fa-folder menu--icon"></i>
                        <span class="menu--label">商品類別管理</span>
                    </a>
                </li>
                <li class="menu--item 12">
                    <a href="back-product-coupon_manage.html" class="menu--link" title="商品優惠券管理"
                       data-bs-toggle="tooltip" data-bs-placement="right">
                        <i class="fa-solid fa-percent menu--icon"></i>
                        <span class="menu--label">商品優惠券管理</span>
                    </a>
                </li>
                <li class="menu--item 16">
                    <a href="back-product-comment_manager.html" class="menu--link" title="商品評論管理"
                       data-bs-toggle="tooltip" data-bs-placement="right">
                        <i class="fa-regular fa-comments menu--icon"></i>
                        <span class="menu--label">商品評論管理</span>
                    </a>
                </li>
                <li class="menu--item 15">
                    <a href="back-product-order_manage.html" class="menu--link" title="商品訂單管理"
                       data-bs-toggle="tooltip" data-bs-placement="right">
                        <i class="fa-solid fa-file-invoice menu--icon"></i>
                        <span class="menu--label">商品訂單管理</span>
                    </a>
                </li>
                <li class="menu--item 13" style="display: none;">
                    <!-- 缺網址 -->
                    <a href="#" class="menu--link" title="帳務管理" data-bs-toggle="tooltip" data-bs-placement="right">
                        <i class="fa-solid fa-coins menu--icon"></i>
                        <span class="menu--label">帳務管理</span>
                    </a>
                </li>
                <li class="menu--item 4">
                    <!-- 缺網址 -->
                    <a href="#" class="menu--link" title="常見問題管理" data-bs-toggle="tooltip"
                       data-bs-placement="right">
                        <i class="fa-solid fa-question-circle menu--icon"></i>
                        <span class="menu--label">常見問題管理</span>
                    </a>
                </li>
                <li class="menu--item 5" style="display: none;">
                    <!-- 缺網址 -->
                    <a href="#" class="menu--link" title="客服即時通" data-bs-toggle="tooltip" data-bs-placement="right">
                        <i class="fa-solid fa-headset menu--icon"></i>
                        <span class="menu--label">客服即時通</span>
                    </a>
                </li>
                <li class="menu--item 14">
                    <a href="back-users-host.html" class="menu--link" title="主辦單位管理" data-bs-toggle="tooltip"
                       data-bs-placement="right">
                        <i class="fa-solid fa-square-plus menu--icon"></i>
                        <span class="menu--label">主辦單位管理</span>
                    </a>
                </li>
                <li class="menu--item 3">
                    <a href="back-users-member.html" class="menu--link" title="會員資料管理" data-bs-toggle="tooltip"
                       data-bs-placement="right">
                        <i class="fa-solid fa-user-group menu--icon"></i>
                        <span class="menu--label">會員資料管理</span>
                    </a>
                </li>
                <li class="menu--item 9">
                    <a href="back-users-my-team.html" class="menu--link" title="後台帳號權限管理" data-bs-toggle="tooltip"
                       data-bs-placement="right">
                        <i class="fa-solid fa-user-secret menu--icon"></i>
                        <span class="menu--label">後台帳號及權限管理</span>
                    </a>
                </li>
                <li class="menu--item 7" style="display: none;">
                    <!-- 缺網址 -->
                    <a href="#" class="menu--link" title="系統參數管理" data-bs-toggle="tooltip"
                       data-bs-placement="right">
                        <i class="fa-solid fa-gear menu--icon"></i>
                        <span class="menu--label ">系統參數管理</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<!-- Left Sidebar End -->
<!-- Body Start -->
<div class="wrapper wrapper-body">
    <div class="dashboard-body">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <div class="d-main-title">
                        <h3>
                            節目評論管理
                        </h3>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="main-card mt-5">
                        <div class="dashboard-wrap-content p-4">
                            <div class="nav custom2-tabs btn-group" role="tablist">
                                <button id="allCommentTab" class="tab-link ms-0 active" data-bs-toggle="tab"
                                        data-bs-target="#orders-tab" type="button" role="tab" aria-controls="orders-tab"
                                        aria-selected="true" onclick="commentbtn()"><span class="total_event_counter">節目評論</span>
                                </button>
                                <button id="allReportTab" class="tab-link" data-bs-toggle="tab"
                                        data-bs-target="#tickets-tab"
                                        type="button" role="tab" aria-controls="tickets-tab" aria-selected="false"
                                        onclick="reportbtn()">受檢舉評論
                                </button>
                            </div>
                            <div class="d-md-flex flex-wrap align-items-center">
                                <div class="dashboard-date-wrap mt-4">
                                    <div class="form-group">
                                        <div class="relative-input position-relative">
                                            <input id="showName" class="form-control h_40" type="text"
                                                   placeholder="搜尋節目"
                                                   value="" onblur="search()">
                                            <i class="uil uil-search"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="rs ms-auto mt-4 mt_r4">
                                    <button type="button" class="pe-4 w-100 ps-4 text-center
                                            co-main-btn h_40 d-inline-block" onclick="refresh()">
                                        <i class="fa-solid fa-arrow-rotate-right me-3"></i>重新整理
                                    </button>
                                </div>
                            </div>
                            <div class="main-form mt-4">
                                <div class="row g-3">
                                    <div class="col-lg-3 col-md-6">
                                        <div class="form-group">
                                            <select id="showSelector" class="form-select" data-size="5"
                                                    data-live-search="true" name="activityno">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-6">
                                        <div class="form-group">
                                            <select id="statusSelector" name="areportno" class="form-select">
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="event-list">
                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="orders-tab" role="tabpanel">
                                <div class="table-card mt-4">
                                    <div class="main-table">
                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead class="thead-dark">
                                                <th scope="col" style="width: 15%">評論日期</th>
                                                <th scope="col" style="width: 15%">會員姓名</th>
                                                <th scope="col" style="width: 15%">節目名稱</th>
                                                <th scope="col" style="width: 20%">評論內容</th>
                                                <th scope="col" style="width: 10%">評論星等</th>
                                                <th scope="col" style="width: 10%">評論讚數</th>
                                                <th scope="col" style="width: 15%">評論狀態</th>
                                                </thead>
                                                <tbody id="commentbody">
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="tab-pane fade" id="tickets-tab" role="tabpanel">
                                <div class="table-card mt-4">
                                    <div class="main-table">
                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead class="thead-dark">
                                                <th scope="col" style="width: 15%">受評論日期</th>
                                                <th scope="col" style="width: 12.5%">檢舉者</th>
                                                <th scope="col" style="width: 12.5%">評論者</th>
                                                <th scope="col" style="width: 10%">節目名稱</th>
                                                <th scope="col" style="width: 15%">檢舉原因</th>
                                                <th scope="col" style="width: 15%">評論內容</th>
                                                <th scope="col" style="width: 20%">處理狀態</th>
                                                </thead>
                                                <tbody id="reportbody">
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <!-- 分頁-->
                                <div id="reportPagination" style="margin-top: 20px">
                                    <nav aria-label="Page navigation example"
                                         style="text-align: center">
                                        <ul class="pagination justify-content-sm-center">
                                        </ul>
                                    </nav>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Body End -->

<!-- 受檢舉評論內容開始-->
<div class="modal fade" id="inviteTeamModal_bad" tabindex="-1"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">檢舉原因/評論內容</h5>
                <button type="button" class="close-model-btn" data-bs-dismiss="modal" aria-label="Close"><i
                        class="uil uil-multiply"></i></button>
            </div>
            <div class="modal-body">
                <div class="model-content main-form">
                    <input id="areportNo" type="text" value="" style="display: none">
                    <div class="form-group mt-30">
                        <label class="form-label">檢舉原因：</label>
                        <textarea id="rreason" class="form-textarea" disabled></textarea>
                    </div>
                    <div class="form-group mt-30">
                        <label class="form-label">評論內容：</label>
                        <input id="rcommentId" type="hidden" value="">
                        <textarea id="rcomment" class="form-textarea" disabled></textarea>
                    </div>
                    <div class="form-group mt-30">
                        <label class="form-label">評論狀態：</label>
                        <select id="rstatus" class="form-select text-bg-light p-3">
                            <option value="0" selected disabled>未處理</option>
                            <option value="1">已處理 (顯示)</option>
                            <option value="2">已處理 (不顯示)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="co-main-btn min-width btn-hover h_40"
                        data-bs-dismiss="modal">取消修改
                </button>
                <button type="button" class="main-btn min-width btn-hover h_40"
                        data-bs-dismiss="modal" onclick="confirm_bad()">確認修改
                </button>
            </div>
        </div>
    </div>
</div>
<!-- 受檢舉評論內容結束-->

<!-- 顯示評論內容開始-->
<div class="modal fade" id="inviteTeamModal_good" tabindex="-1"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">評論內容</h5>
                <button type="button" class="close-model-btn" data-bs-dismiss="modal" aria-label="Close"><i
                        class="uil uil-multiply"></i></button>
            </div>
            <div class="modal-body">
                <div class="model-content main-form">
                    <input id="acommentNo" type="text" value="" style="display: none">
                    <div class="form-group mt-30">
                        <label class="form-label">評論內容：</label>
                        <textarea id="ccontent" class="form-textarea" disabled></textarea>
                    </div>
                    <div class="form-group mt-30">
                        <label class="form-label">評論狀態：</label>
                        <select id="cstatus" class="form-select text-bg-light p-3">
                            <option value="0">取消顯示</option>
                            <option value="1" selected>正常顯示</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="co-main-btn min-width btn-hover h_40"
                        data-bs-dismiss="modal">取消修改
                </button>
                <button type="button" class="main-btn min-width btn-hover h_40"
                        data-bs-dismiss="modal" onclick="confirm_good()">確認修改
                </button>
            </div>
        </div>
    </div>
</div>
<!-- 顯示評論內容結束-->
</body>


<script src="js/vertical-responsive-menu.min.js"></script>
<script src="js/jquery-3.6.0.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="vendor/OwlCarousel/owl.carousel.js"></script>
<script src="vendor/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
<script src="js/custom.js"></script>
<script
        src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!-- Kai  backuserData -->
<script src="js/backuserData.js"></script>

<script>
    // 當網頁載入時先呈現所有節目評論
    $(document).ready(function () {
        commentbtn();
    })

    // 所有受檢舉評論
    const commentbody = document.querySelector('#commentbody');
    const reportbody = document.querySelector('#reportbody');
    const statusSelector = document.getElementById('statusSelector');
    const showSelector = document.getElementById('showSelector');

    // 點擊 "受檢舉評論"，顯示頁面
    function reportbtn() {
        $('#showName').val('');

        // 選單(狀態)呈現
        $('#statusSelector').html(`
                <option value="all" selected>所有狀態</option>
                <option value="0" disabled>未處理</option>
                <option value="1">已處理 (顯示)</option>
                <option value="2">已處理 (不顯示)</option>
            `);

        // 選單(節目)呈現
        $('#showSelector').html(`
                <option value="all" selected>所有節目</option>
            `);

        // 選單(節目)呈現 - 動態
        fetch('areport/AReportANames')
            .then((resp) => resp.json())
            .then((jsondata) => {
                for (let i of jsondata) {
                    document.getElementById('showSelector').innerHTML += `
                            <option value="${i[0]}">${i[1]}</option>
                        `
                }
            })

        $.ajax({
            url: 'areport/ListAll',
            dataType: 'json',
            success: function (jsondata) {
                displayAReports(jsondata);
            }
        });

        // 複合查詢
        statusSelector.addEventListener('change', function () {
            $('#showName').val('');

            let reqbody = {
                'activityno': String(showSelector.value),
                'areportstatus': String(statusSelector.value)
            };

            fetch('areport/BySelection', {
                method: "POST",
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(reqbody)
            })
                .then((resp) => resp.json())
                .then((jsondata) => {
                    displayAReports(jsondata);
                })
        })

        showSelector.addEventListener('change', function () {
            $('#showName').val('');

            let reqbody = {
                'activityno': String(showSelector.value),
                'areportstatus': String(statusSelector.value)
            };

            fetch('areport/BySelection', {
                method: "POST",
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(reqbody)
            })
                .then((resp) => resp.json())
                .then((jsondata) => {
                    displayAReports(jsondata);
                })
        })
    }

    // 點擊單一受檢舉評論並顯示
    function showreport(reportno) {
        let report = null;
        let url = 'areport/ListOneAReport' + `?reportId=${reportno}`;

        fetch(url)
            .then((resp) => resp.json())
            .then((jsondata) => {
                report = jsondata;
                $('#areportNo').val("");
                let rreason = document.querySelector('#rreason');
                rreason.innerHTML = "";
                let rcomment = document.querySelector('#rcomment');
                rcomment.innerHTML = "";
                let rcommentId = document.querySelector('#rcommentId');
                rcommentId.value = "";

                $('#areportNo').val(report.areportNo);
                rreason.innerHTML += `${report.awhy}`;
                rcommentId.value = report.acomment.acommentNo;
                rcomment.innerHTML += `${report.acomment.acommentCont}`;
                if (Number(report.areportStatus) === 0) {
                    $("#rstatus>option[value='0']").prop("selected", true);
                } else if (Number(report.areportStatus) === 1) {
                    $("#rstatus>option[value='1']").prop("selected", true);
                } else {
                    $("#rstatus>option[value='2']").prop("selected", true);
                }
            })

        return reportno;
    }

    // 修改受檢舉評論狀態
    function confirm_bad() {
        // SweetAlert
        Swal.fire({
            title: '確認將此檢舉評論狀態修改？',
            showDenyButton: true,
            showCancelButton: false,
            confirmButtonText: '確認',
            denyButtonText: `取消`,
        }).then((result) => {
            if (result.isConfirmed) {
                // 連動評論狀態
                if ($('#rstatus').val() !== "2") { // 不是被決定為取消顯示，都會出現在評論頁面
                    fetch("/acomment/UpdateOneAComment" + `?commentId=${$('#rcommentId').val()}&commentStatus=1`)
                } else {
                    fetch("/acomment/UpdateOneAComment" + `?commentId=${$('#rcommentId').val()}&commentStatus=0`)
                }

                url = `areport/UpdateOneAReport` + `?reportId=${$('#areportNo').val()}&reportStatus=${$('#rstatus').val()}`;
                fetch(url)
                    .then((resp) => resp.json())
                    .then((jsondata) => {
                        if (Number(jsondata) == 1) {
                            reportbtn();
                        } else
                            alert("請重新更新狀態");
                    })
            } else if (result.isDenied) {
                return;
            }
        })
    }

    // 顯示受檢舉評論
    function displayAReports(jsondata) {
        reportbody.innerHTML = "";

        for (let j of jsondata) {

            reportbody.innerHTML += `
                            <td>${j.areportDate}</td>
                            <td>${j.member.mname}</td>
                            <td>${j.acomment.member.mname}</td>
                            <td>
                                <a href="#" target="_blank">
                                    <div style="width: 150px; height: 50px;">
                                        <p class="ellipsis" style="font-weight: 500; color: #000 !important; line-height: 50px;">${j.acomment.activity.aname}</p>
                                    </div>
                                </a>
                            </td>
                            <td>
							    <button name="${j.areportNo}" style="border: none; background-color: transparent;" data-bs-toggle="modal" data-bs-target="#inviteTeamModal_bad" onclick="showreport(this.name)">
								    <div style="width: 150px; height: 50px;">
									    <p class="ellipsis" style="text-align:left !important; font-weight: 500; color: #000 !important; line-height: 50px;">${j.awhy}</p>
								    </div>
							    </button>
						    </td>
						    <td>
							    <button name="${j.areportNo}" style="border: none; background-color: transparent;" data-bs-toggle="modal" data-bs-target="#inviteTeamModal_bad" onclick="showreport(this.name)">
								    <div style="width: 150px; height: 50px;">
									    <p class="ellipsis" style="text-align:left !important; font-weight: 500; color: #000 !important; line-height: 50px;">${j.acomment.acommentCont}</p>
								    </div>
							    </button>
						    </td>
						    <td id="areportstatus_${j.areportNo}">
						    </td>
                            `;

            let areportstatus = document.getElementById(`areportstatus_${j.areportNo}`);

            if (j.areportStatus == 0) {
                areportstatus.innerHTML +=
                    `<span class="status-circle blue-circle"></span>未處理`;
            } else if (j.areportStatus == 1) {
                areportstatus.innerHTML +=
                    `<span class="status-circle green-circle"></span>已處理 (顯示)`;
            } else {
                areportstatus.innerHTML +=
                    `<span class="status-circle red-circle"></span>已處理 (不顯示)`;
            }
        }
        ;
    }

    // ========================================================================================================= //

    // 點擊 "所有評論"，顯示頁面
    function commentbtn() {
        $('#showName').val('');

        // 選單(狀態)呈現
        $('#statusSelector').html(`
                <option value="all" selected>所有狀態</option>
                <option value="0">取消顯示</option>
                <option value="1">正常顯示</option>
            `);

        // 選單(節目)呈現
        $('#showSelector').html(`
                <option value="all" selected>所有節目</option>
            `);

        // 選單(節目)呈現 - 動態
        fetch('acomment/ACommentANames')
            .then((resp) => resp.json())
            .then((jsondata) => {
                for (let i of jsondata) {
                    document.getElementById('showSelector').innerHTML += `
                            <option value="${i[0]}">${i[1]}</option>
                        `
                }
            })

        fetch('acomment/ListAll')
            .then((resp) => resp.json())
            .then((jsondata) => {
                displayAComments(jsondata);
            })

        // 複合查詢
        statusSelector.addEventListener('change', function () {
            $('#showName').val('');

            let reqbody = {
                'activityno': String(showSelector.value),
                'acommentstatus': String(statusSelector.value)
            };

            fetch('acomment/BySelection', {
                method: "POST",
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(reqbody)
            })
                .then((resp) => resp.json())
                .then((jsondata) => {
                    displayAComments(jsondata);
                })
        })

        showSelector.addEventListener('change', function () {
            $('#showName').val('');

            let reqbody = {
                'activityno': String(showSelector.value),
                'acommentstatus': String(statusSelector.value)
            };

            fetch('acomment/BySelection', {
                method: "POST",
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(reqbody)
            })
                .then((resp) => resp.json())
                .then((jsondata) => {
                    displayAComments(jsondata);
                })
        })
    }

    // 點擊單一評論並顯示
    function showcomment(commentno) {
        fetch('acomment/ListOneAComment' + `?commentId=${commentno}`)
            .then((resp) => resp.json())
            .then((jsondata) => {
                $('#acommentNo').val("");
                let ccontent = document.querySelector('#ccontent');
                ccontent.innerHTML = "";

                $('#acommentNo').val(jsondata.acommentNo);
                ccontent.innerHTML += `${jsondata.acommentCont}`;
                if (Number(jsondata.acommentStatus) === 0) {
                    $("#cstatus>option[value='0']").prop("selected", true);
                } else if (Number(jsondata.acommentStatus) === 1) {
                    $("#cstatus>option[value='1']").prop("selected", true);
                } else {
                    $("#cstatus>option[value='2']").prop("selected", true);
                }
            })

        return commentno;
    }

    // 修改評論狀態
    function confirm_good() {
        // SweetAlert
        Swal.fire({
            title: '確認將此評論狀態修改？',
            showDenyButton: true,
            showCancelButton: false,
            confirmButtonText: '確認',
            denyButtonText: `取消`,
        }).then((result) => {
            if (result.isConfirmed) {
                fetch(`acomment/UpdateOneAComment` + `?commentId=${$('#acommentNo').val()}&commentStatus=${$('#cstatus').val()}`)
                    .then((resp) => resp.json())
                    .then((jsondata) => {
                        if (Number(jsondata) == 1) {
                            commentbtn();
                        } else
                            alert("請重新更新狀態");
                    })
            } else if (result.isDenied) {
                return;
            }
        })
    }

    // 顯示評論
    function displayAComments(jsondata) {
        commentbody.innerHTML = "";

        for (let j of jsondata) {
            commentbody.innerHTML += `
                            <td>${j.acommentDate}</td>
                            <td>${j.member.mname}</td>
                            <td>
                                <a href="#" target="_blank">
                                    <div style="width: 150px; height: 50px;">
                                        <p class="ellipsis" style="font-weight: 500; color: #000 !important; line-height: 50px;">${j.activity.aname}</p>
                                    </div>
                                </a>
                            </td>
                            <td>
							    <button name="${j.acommentNo}" style="border: none; background-color: transparent;" data-bs-toggle="modal" data-bs-target="#inviteTeamModal_good" onclick="showcomment(this.name)">
								    <div style="width: 150px; height: 50px;">
									    <p class="ellipsis" style="text-align:left !important; font-weight: 500; color: #000 !important; line-height: 50px;">${j.acommentCont}</p>
								    </div>
							    </button>
						    </td>
						    <td>${j.arate}</td>
						    <td>${j.alike}</td>
						    <td id="acommentstatus_${j.acommentNo}">
						    </td>
                            `;

            let acommentstatus = document.getElementById(`acommentstatus_${j.acommentNo}`);

            if (j.acommentStatus == 0) {
                acommentstatus.innerHTML +=
                    `<span class="status-circle red-circle"></span>取消顯示`;
            } else if (j.acommentStatus == 1) {
                acommentstatus.innerHTML +=
                    `<span class="status-circle green-circle"></span>正常顯示`;
            }
        }
        ;
    }

    // ========================================================================================================= //
    // 重新整理頁面
    function refresh() {
        if ($('#allCommentTab').attr('aria-selected') == 'true')
            commentbtn();
        else {
            reportbtn();
        }
    }

    // 模糊比對節目的所有評論或受檢舉評論
    function search() {
        $("#showSelector>option[value='all']").prop("selected", true);
        $("#statusSelector>option[value='all']").prop("selected", true);

        url_acomment = `acomment/ByActName` + `?actName=${$('#showName').val()}`;
        url_areport = `areport/ByActName` + `?actName=${$('#showName').val()}`;

        if ($('#allCommentTab').attr('aria-selected') == 'true') {
            fetch(url_acomment)
                .then((resp) => resp.json())
                .then((jsondata) => {
                    displayAComments(jsondata);
                })
        } else {
            fetch(url_areport)
                .then((resp) => resp.json())
                .then((jsondata) => {
                    displayAReports(jsondata);
                })
        }
    }

    // 分頁
    // const pageSize = 1;
    //
    // $('#reportPagination ul.pagination').html('');
    //
    // $('#reportPagination ul.pagination').append(`
    //     <li class="page-item">
    //         <a class="page-link" href="#" aria-label="Previous">
    //             <span aria-hidden="true">&laquo;</span>
    //             <span class="sr-only">Previous</span>
    //         </a>
    //     </li>
    //     `);
    //
    // for (let i = 1; i <= Math.ceil(reportSize / pageSize); i++) {
    //     $('#reportPagination ul.pagination').append(`
    //         <li class="page-item"><a class="page-link" href="">${i}</a></li>
    //     `);
    // }
    //
    // $('#reportPagination ul.pagination').append(`
    //     <li class="page-item">
    //         <a class="page-link" href="#" aria-label="Next">
    //             <span aria-hidden="true">&raquo;</span>
    //             <span class="sr-only">Next</span>
    //         </a>
    //     </li>
    //     `);


</script>

</html>